!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).version=e()}(this,(function(){"use strict";class t{constructor(){this.namespace="",this.data={},this.existingProxy=[]}init(t){if(!t)throw new Error("请传入命名空间");if(this.namespace=t,!this.data[t]){const e=window.localStorage.getItem("finoData_"+t),a=e&&JSON.parse(e);this.set(a,t)}if(!this.data.global){const t=window.localStorage.getItem("finoData_global"),e=t&&JSON.parse(t);this.set({...e},"global")}}set(e,a){if(a&&function(e){const a=new t;return Object.keys(a).includes(e)}(a))return void console.error(a+"是数据仓库的关键字，请更改命名空间");if("object"!=typeof(s=e)||null===s)return void console.error("设置的数据必须是一个对象");var s;const i=a||this.namespace;let n=this.data[i]||{};this.data[i]=Object.assign(n,e,{_spacename:i});for(let t in e)this.proxyOfprototype(e,i,t);this.data[i]=this.proxyOfcontent(i),this.synchronizeDataInCache(i)}get(t,e){return!t&&e?this.data[this.namespace]:t&&!e&&this.data[this.namespace]&&void 0!==this.data[this.namespace][t]?this.data[this.namespace][t]:e&&t&&this.data[e]?this.data[e][t]:void 0}clear(){if(!this.data[this.namespace])return;Object.keys(this.data[this.namespace]).forEach(t=>{"spacename"!==t&&delete this[t]}),this.data[this.namespace]=null}proxyOfprototype(t,e,a){if("_spacename"===a)return;const s=e||this.namespace,i={get:()=>this.data[s][a],set:t=>{this.data[a]=t,this.data[s][a]=t},enumerable:!0,configurable:!0};Object.defineProperty(this,a,i)}proxyOfcontent(t){if(this.existingProxy.includes(t))return this.data[t];let e=this.setProxy(this.data[t]);return this.synchronizeDataInCache(t),this.existingProxy.push(t),e}synchronizeDataInCache(t){const e=this.data[t],a=this.data.global;window.localStorage.setItem("finoData_"+t,JSON.stringify(e)),window.localStorage.setItem("finoData_global",JSON.stringify(a)),window.$event&&window.$event.notify("dataChange")}setProxy(t){return new Proxy(t,{get:(t,e,a)=>Reflect.get(t,e,a),set:(t,e,a,s)=>{const i=t[e];if(t._spacename!==this.namespace&&"global"!==t._spacename)return console.error("不允许修改其他数据仓库的数据"),i;return Reflect.set(t,e,a,s)}})}}return console.log("databnase改变了最终版9"),t}));
//# sourceMappingURL=finoer-store.umd.min.js.map
